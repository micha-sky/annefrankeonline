parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"GJTw":[function(require,module,exports) {
function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}var s=function(){function t(i){var s=this;e(this,t),this.scene=new THREE.Scene,this.vertex="varying vec2 vUv;void main() {vUv = uv;gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );}",this.fragment=i.fragment,this.uniforms=i.uniforms,this.renderer=new THREE.WebGLRenderer,this.width=window.innerWidth,this.height=window.innerHeight,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(15658734,1),this.duration=i.duration||1,this.debug=i.debug||!0,this.easing=i.easing||"easeInOut",this.clicker=document.getElementById("content"),this.container=document.getElementById("slider");var n=this.container.getAttribute("data-images");console.log(n),this.images=JSON.parse(n),this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.container.appendChild(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.001,1e3),this.camera.position.set(0,0,2),this.time=0,this.current=0,this.textures=[],this.paused=!0,this.initiate(function(){console.log(s.textures),console.log("initiating"),s.setupResize(),s.settings(),s.addObjects(),s.resize(),s.clickEvent(),s.play()})}return i(t,[{key:"initiate",value:function(e){console.log("initiating");var t=[],i=this;this.images.forEach(function(e,s){var n=new Promise(function(t){i.textures[s]=(new THREE.TextureLoader).load(e,t),i.textures[s].minFilter=THREE.LinearFilter});t.push(n)}),Promise.all(t).then(function(){e()})}},{key:"clickEvent",value:function(){var e=this;this.clicker.addEventListener("click",function(){e.next()})}},{key:"settings",value:function(){var e=this;console.log("setting");this.debug&&(this.gui=new dat.GUI),this.settings={progress:.5},this.debug&&this.gui.add(this.settings,"progress",0,1,.01),Object.keys(this.uniforms).forEach(function(t){e.settings[t]=e.uniforms[t].value,e.debug&&e.gui.add(e.settings,t,e.uniforms[t].min,e.uniforms[t].max,.01)})}},{key:"setupResize",value:function(){window.addEventListener("resize",this.resize.bind(this))}},{key:"resize",value:function(){var e,t;this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.renderer.setSize(this.width,this.height),this.camera.aspect=this.width/this.height,this.imageAspect=this.textures[0].image.height/this.textures[0].image.width,this.height/this.width>this.imageAspect?(e=this.width/this.height*this.imageAspect,t=1):(e=1,t=this.height/this.width/this.imageAspect),this.material.uniforms.resolution.value.x=this.width,this.material.uniforms.resolution.value.y=this.height,this.material.uniforms.resolution.value.z=e,this.material.uniforms.resolution.value.w=t;var i=this.camera.position.z;this.camera.fov=180/Math.PI*2*Math.atan(1/(2*i)),this.plane.scale.x=this.camera.aspect,this.plane.scale.y=1,this.camera.updateProjectionMatrix()}},{key:"addObjects",value:function(){this.material=new THREE.ShaderMaterial({extensions:{derivatives:"#extension GL_OES_standard_derivatives : enable"},side:THREE.DoubleSide,uniforms:{time:{type:"f",value:0},progress:{type:"f",value:0},border:{type:"f",value:0},intensity:{type:"f",value:0},scaleX:{type:"f",value:40},scaleY:{type:"f",value:40},transition:{type:"f",value:40},swipe:{type:"f",value:0},width:{type:"f",value:0},radius:{type:"f",value:0},texture1:{type:"f",value:this.textures[0]},texture2:{type:"f",value:this.textures[1]},displacement:{type:"f",value:(new THREE.TextureLoader).load("img/disp3.jpg")},resolution:{type:"v4",value:new THREE.Vector4}},vertexShader:this.vertex,fragmentShader:this.fragment}),this.geometry=new THREE.PlaneGeometry(1,1,2,2),this.plane=new THREE.Mesh(this.geometry,this.material),this.scene.add(this.plane)}},{key:"stop",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1,this.render()}},{key:"next",value:function(){var e=this;if(!this.isRunning){this.isRunning=!0;var t=this.textures.length,i=this.textures[(this.current+1)%t];this.material.uniforms.texture2.value=i,(new TimelineMax).to(this.material.uniforms.progress,this.duration,{value:1,ease:Power2[this.easing],onComplete:function(){console.log("FINISH"),e.current=(e.current+1)%t,e.material.uniforms.texture1.value=i,e.material.uniforms.progress.value=0,e.isRunning=!1}})}}},{key:"render",value:function(){var e=this;this.paused||(this.time+=.3,this.material.uniforms.time.value=this.time,console.log("render"),console.log(this.material.uniforms.progress.value),Object.keys(this.uniforms).forEach(function(t){e.material.uniforms[t].value=e.settings[t]}),requestAnimationFrame(this.render.bind(this)),this.renderer.render(this.scene,this.camera))}}]),t}();
},{}]},{},["GJTw"], null)
//# sourceMappingURL=sketch.78fb71f2.js.map